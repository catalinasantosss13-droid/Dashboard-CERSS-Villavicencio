<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Dashboard CERS – Villavicencio</title>

<!-- Fuente -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
    body {
        font-family: 'Montserrat', sans-serif;
        margin: 0;
        background: #f4f6f9;
    }

    header {
        background: #1d3557;
        padding: 18px;
        text-align: center;
        color: white;
        font-size: 24px;
        font-weight: 700;
        letter-spacing: 1px;
    }

    .tabs {
        display: flex;
        justify-content: center;
        background: white;
        border-bottom: 1px solid #ddd;
    }

    .tab {
        padding: 15px 25px;
        cursor: pointer;
        font-weight: 600;
        color: #555;
    }

    .tab.active {
        color: #1d3557;
        border-bottom: 3px solid #1d3557;
    }

    .content {
        display: none;
        padding: 25px;
    }

    .content.active {
        display: block;
    }

    .kpi-container {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
    }

    .kpi {
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 3px 10px rgba(0,0,0,0.08);
        flex: 1 1 200px;
    }

    .kpi h3 {
        font-size: 16px;
        font-weight: 600;
        color: #444;
        margin: 0;
    }

    .kpi p {
        font-size: 28px;
        font-weight: 700;
        margin: 5px 0 0;
        color: #1d3557;
    }

    .chart-box {
        margin-top: 30px;
        background: white;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 3px 10px rgba(0,0,0,0.08);
    }

</style>
</head>

<body>

<header>Dashboard CERS – Villavicencio</header>

<!-- TABS -->
<div class="tabs">
    <div class="tab active" onclick="openTab(event, 'nacional')">NACIONAL</div>
    <div class="tab" onclick="openTab(event, 'internacional')">INTERNACIONAL</div>
    <div class="tab" onclick="openTab(event, 'general')">GENERAL</div>
</div>

<!-- CONTENIDO DE CADA TAB -->
<div id="nacional" class="content active">
    <h2>Nacional</h2>
    <div class="kpi-container" id="kpi-nacional"></div>
    <div class="chart-box"><canvas id="chart-nacional"></canvas></div>
</div>

<div id="internacional" class="content">
    <h2>Internacional</h2>
    <div class="kpi-container" id="kpi-internacional"></div>
    <div class="chart-box"><canvas id="chart-internacional"></canvas></div>
</div>

<div id="general" class="content">
    <h2>General</h2>
    <div class="kpi-container" id="kpi-general"></div>
    <div class="chart-box"><canvas id="chart-general"></canvas></div>
</div>

<script>

// ------------ URLs de tus CSV públicos ----------------
const urls = {
    nacional: "https://docs.google.com/spreadsheets/d/e/2PACX-1vR3D2ho2jJV0hYbNOzVweclC4SYDifw5AGMEV8HO318cgxpl9tz4nkocubdFCrxxOX7Z8DZ21Ex-1IG/pub?gid=563980265&single=true&output=csv",
    internacional: "https://docs.google.com/spreadsheets/d/e/2PACX-1vR3D2ho2jJV0hYbNOzVweclC4SYDifw5AGMEV8HO318cgxpl9tz4nkocubdFCrxxOX7Z8DZ21Ex-1IG/pub?gid=804794750&single=true&output=csv",
    general: "https://docs.google.com/spreadsheets/d/e/2PACX-1vR3D2ho2jJV0hYbNOzVweclC4SYDifw5AGMEV8HO318cgxpl9tz4nkocubdFCrxxOX7Z8DZ21Ex-1IG/pub?gid=24842196&single=true&output=csv"
};

// ------------ Función para leer CSV ----------------
async function loadCSV(url) {
    const res = await fetch(url);
    const text = await res.text();

    const rows = text.trim().split("\n").map(r => r.split(","));
    const headers = rows[0];
    const data = rows.slice(1);

    return { headers, data };
}

// ------------ KPI AUTOMÁTICOS ----------------
function renderKPIs(section, data) {
    const container = document.getElementById("kpi-" + section);

    const totalRegistros = data.length;
    const columnas = data[0].length;
    const vacíos = data.flat().filter(v => v.trim() === "").length;

    container.innerHTML = `
        <div class="kpi"><h3>Total registros</h3><p>${totalRegistros}</p></div>
        <div class="kpi"><h3>Número de columnas</h3><p>${columnas}</p></div>
        <div class="kpi"><h3>Campos vacíos</h3><p>${vacíos}</p></div>
    `;
}

// ------------ Gráfico básico para ejemplificar ----------------
function renderChart(section, headers, data) {
    const ctx = document.getElementById("chart-" + section);

    // Tomamos la primera columna como categorías y la segunda como valores
    const labels = data.slice(0, 10).map(row => row[0]);
    const values = data.slice(0, 10).map(row => Number(row[1]) || 0);

    new Chart(ctx, {
        type: "bar",
        data: {
            labels,
            datasets: [{
                label: "Valores",
                data: values
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { display: false } }
        }
    });
}

// ------------ Cargar datos para cada tabla ----------------
async function loadSection(section) {
    const csv = await loadCSV(urls[section]);
    renderKPIs(section, csv.data);
    renderChart(section, csv.headers, csv.data);
}

// Cargar todas al inicio
loadSection("nacional");
loadSection("internacional");
loadSection("general");


// ------------ Tabs ----------------
function openTab(event, tabName) {
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    event.target.classList.add("active");

    document.querySelectorAll(".content").forEach(c => c.classList.remove("active"));
    document.getElementById(tabName).classList.add("active");
}

</script>

</body>
</html>
